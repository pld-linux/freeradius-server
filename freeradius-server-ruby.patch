diff -ur freeradius-server-2.1.10.orig//src/modules/rlm_ruby/rlm_ruby.c freeradius-server-2.1.10/src/modules/rlm_ruby/rlm_ruby.c
--- freeradius-server-2.1.10.orig//src/modules/rlm_ruby/rlm_ruby.c	2010-09-28 13:03:56.000000000 +0200
+++ freeradius-server-2.1.10/src/modules/rlm_ruby/rlm_ruby.c	2010-11-24 13:26:16.021268990 +0100
@@ -113,7 +113,7 @@
     }
 
     /* Get the array size. */
-    outertuplesize = RARRAY(rb_value)->len;
+    outertuplesize = RARRAY_LEN(rb_value);
 
     for (i = 0; i < outertuplesize; i++) {
         VALUE pTupleElement = rb_ary_entry(rb_value, i);
@@ -124,7 +124,7 @@
             /* Check if it's a pair */
             int tuplesize;
 
-            if ((tuplesize = RARRAY(pTupleElement)->len) != 2) {
+            if ((tuplesize = RARRAY_LEN(pTupleElement)) != 2) {
                 radlog(L_ERR, "%s: tuple element %d is a tuple "
                         " of size %d. must be 2\n", function_name,
                         i, tuplesize);
